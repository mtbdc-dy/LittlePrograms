# -*- coding: utf-8 -*-
# @Time : 2019-07-01 01:07
# @Author : 徐缘
# @FileName: title_classifier.py
# @Software: PyCharm


import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB

data_train = pd.read_csv('./archive/title_vector_34.csv', sep=',')
label = pd.read_csv('./title_class.csv')

print(data_train.shape, label.shape)
# print(label)
x_train, x_test, y_train, y_test = train_test_split(data_train, label, random_state=1234)


# 引用朴素贝叶斯进行分类训练和预测
classifier = GaussianNB()
classifier.fit(x_train, y_train)
print('BERT进行文本特征工程，使用sklearn默认的高斯朴素贝叶斯分类器，验证集上的预测准确率:', classifier.score(x_test, y_test))

# 逻辑回归
lg1 = LogisticRegression()
lg1.fit(x_train, y_train)
print(x_train.shape, y_train.shape)
print('Bert进行sentenceToVector，使用sklearn默认的逻辑回归分类器，验证集上的预测准确率:', lg1.score(x_test, y_test))

# ip
print(lg1.predict([0.40152662992477417, 0.6183801293373108, -0.08014655113220215, -0.2977050244808197, 0.6129085421562195,-0.4422670900821686,0.21896372735500336,-0.48446863889694214,-0.9855989813804626,0.2928090989589691,0.6942300796508789,0.0662405714392662,0.9621941447257996,-0.3401351869106293,2.07551908493042,-0.17407771944999695,-0.204640194773674,-0.8112830519676208,1.0263681411743164,0.24262207746505737,-0.8010259866714478,-0.1471676230430603,-0.08677472174167633,0.18029159307479858,-0.5040315389633179,-0.10704261064529419,0.3112597167491913,-0.2824133038520813,0.5045106410980225,0.7647845149040222,0.4754091501235962,-0.19453337788581848,-0.1199641078710556,0.4000823497772217,0.17777663469314575,-0.5734891295433044,-0.6633919477462769,0.23299571871757507,-0.028056085109710693,0.5621172189712524,0.7565842270851135,-0.8031456470489502,-0.3737451136112213,1.4171485900878906,1.1707792282104492,0.1963697075843811,-0.19156384468078613,-0.19891366362571716,-0.5823347568511963,-0.1330791711807251,0.24344974756240845,10.466302871704102,1.9553742408752441,-0.9046521186828613,-0.5533257722854614,0.1278555691242218,0.16419930756092072,0.8791470527648926,-0.18216779828071594,-0.5447255373001099,-0.0668984055519104,-0.25085094571113586,0.898771345615387,0.38154324889183044,-0.13785474002361298,-0.16862472891807556,-0.22111988067626953,-0.5487164258956909,-1.4372512102127075,-0.6136780977249146,-0.646658718585968,0.6606569290161133,-0.12900497019290924,-0.41556936502456665,-0.32847118377685547,1.4908655881881714,-0.10958176851272583,0.0011796429753303528,-0.10617869347333908,0.0977642834186554,-0.20377343893051147,0.18846581876277924,-1.7337349653244019,0.3778111934661865,-0.4149763286113739,0.5769752860069275,0.1296776533126831,-2.4813854694366455,-0.08938508480787277,-0.17760293185710907,-0.23123474419116974,-0.2255621701478958,-0.1886064112186432,-0.025860900059342384,-0.3253990411758423,0.896514356136322,0.798500120639801,-0.16887366771697998,-0.2910346984863281,-2.069262742996216,0.19207778573036194,0.2002115547657013,0.528619647026062,0.7085261344909668,-1.670815110206604,0.6073092818260193,-0.6015185117721558,0.2710835933685303,-0.2175660878419876,-0.3504006266593933,-0.5110681056976318,-0.02339377999305725,0.21160276234149933,0.2147873342037201,-0.3171883225440979,-0.9653574228286743,-0.8226729035377502,1.3372670412063599,-1.2880759239196777,-0.6595282554626465,-0.10004685819149017,0.8776178359985352,0.3364803194999695,-0.6037595868110657,0.06074541062116623,0.11229905486106873,1.0065526962280273,0.500848114490509,-0.16402173042297363,0.4054163992404938,0.7944900989532471,0.036733947694301605,-0.40650999546051025,-0.461527943611145,0.7914068102836609,-0.16286233067512512,0.4703519940376282,-0.3869210183620453,-0.7745038270950317,0.6044965982437134,-0.5725454092025757,-0.8876127600669861,-0.465570867061615,1.066371202468872,1.040252447128296,-0.8128600120544434,-0.4559583067893982,-0.35085582733154297,-0.10133858025074005,-0.240227609872818,-0.25896647572517395,-0.9027632474899292,0.5131823420524597,-0.5787880420684814,0.21177786588668823,-0.5335097312927246,-0.3250243365764618,-1.238910436630249,0.235856294631958,0.1555619239807129,0.026393994688987732,0.7841705083847046,0.12746305763721466,-0.2764102816581726,0.41966867446899414,-1.4620383977890015,0.1659785807132721,-0.9953048229217529,0.1344430297613144,-0.07407473772764206,0.13184818625450134,0.251830518245697,-1.1000385284423828,0.4060567617416382,0.008578062057495117,-1.21677827835083,-0.47007453441619873,-0.44540879130363464,0.14050331711769104,-1.1690192222595215,0.45506441593170166,-0.47509151697158813,-0.07377690076828003,0.3344588875770569,0.02280118688941002,-0.4117962718009949,0.8533669114112854,0.11406069993972778,-0.5909047722816467,0.5458948612213135,-1.1451568603515625,1.620888113975525,-3.3511061668395996,-0.22594870626926422,-0.832086980342865,-0.4282952845096588,0.3132302761077881,0.10214930772781372,-1.8834421634674072,0.9147708415985107,-0.8558096885681152,-1.1819275617599487,0.1137148067355156,0.5020886063575745,-0.44323259592056274,-0.13965916633605957,0.30724045634269714,0.005198046565055847,0.48876407742500305,0.4790448844432831,-0.06380206346511841,-0.12211912870407104,-0.686151921749115,-0.25556182861328125,0.606196403503418,-0.15999343991279602,0.5991068482398987,0.40659210085868835,0.6289605498313904,0.3979988694190979,0.5891338586807251,0.040847353637218475,1.4328945875167847,-0.8107589483261108,-0.1743982583284378,0.32019177079200745,0.5503003597259521,1.6217509508132935,0.4684296250343323,-0.6398215293884277,-0.14004044234752655,0.12034600973129272,-0.5294132828712463,0.1156291738152504,-0.6192198395729065,0.18457606434822083,0.5848591923713684,0.3886995315551758,0.4208584725856781,0.5514740943908691,0.8180063366889954,-0.11547436565160751,-0.5815552473068237,-0.012366436421871185,0.186862975358963,0.6932113170623779,-0.25668251514434814,0.7652682065963745,-0.2868545651435852,-0.2664322555065155,-0.26925310492515564,-0.7926284074783325,0.571276068687439,0.13898210227489471,-1.4077283143997192,0.007707539945840836,-0.3327248692512512,0.2995491027832031,-0.7796527147293091,0.030041227117180824,0.7283554673194885,-0.46173152327537537,0.33950361609458923,0.24400153756141663,0.06538921594619751,1.2585365772247314,2.183046579360962,-0.5036724209785461,0.9540244340896606,0.22705072164535522,-0.27229565382003784,0.5240887999534607,0.062169481068849564,-0.22385410964488983,-1.4565006494522095,-0.03740289807319641,-0.01685038022696972,0.6136217713356018,1.720112681388855,-0.5262490510940552,0.1864342987537384,-0.48391982913017273,-0.07280358672142029,0.01340554654598236,0.5966466665267944,0.2600666582584381,-0.3102797269821167,0.5582497119903564,-0.47586098313331604,-0.9645448327064514,0.12877912819385529,-0.7226763963699341,-0.5250455737113953,-0.6730666160583496,1.9587258100509644,0.3676353693008423,0.5734352469444275,-0.5295413732528687,0.21643611788749695,0.40819382667541504,-0.5384624004364014,-0.26271289587020874,-0.4219008684158325,0.592049241065979,0.03421686589717865,0.7650929689407349,-0.054145749658346176,0.1600220799446106,-0.4251461625099182,-0.396695077419281,0.3454883396625519,0.16740092635154724,-0.12044449150562286,0.879425048828125,-0.8274434804916382,-0.26992422342300415,-1.1299980878829956,-0.21947577595710754,-0.6121163964271545,-0.5905300378799438,0.42364737391471863,-0.4307653307914734,-0.8306926488876343,0.6221784949302673,0.2532748878002167,0.6135286688804626,-0.3327906131744385,-0.9396153688430786,-0.19713374972343445,-0.5465773344039917,-0.8883630037307739,-0.030531704425811768,0.1323852390050888,-0.15434107184410095,0.2202988713979721,-0.3788696527481079,0.5737091302871704,0.811282217502594,-0.008108317852020264,0.10900074243545532,0.8552622199058533,0.04997260868549347,0.659210205078125,0.9676571488380432,-0.14626693725585938,-0.3895564377307892,-0.8345441818237305,0.08536724746227264,0.08342955261468887,-1.2243287563323975,-0.9145054221153259,0.48254451155662537,-0.679923415184021,0.9789430499076843,-0.6257435083389282,1.8364912271499634,0.06108785420656204,-0.9473181962966919,0.1512782871723175,1.2298638820648193,0.29780590534210205,0.22309502959251404,-0.8243626952171326,-0.0014774352312088013,-0.37270477414131165,0.5199514031410217,-0.41400930285453796,-0.09658432006835938,-0.4450199604034424,0.21538439393043518,-0.4651842415332794,0.622157633304596,0.5898361802101135,-1.2644754648208618,0.7250937819480896,0.6477091312408447,0.43920260667800903,1.1926655769348145,0.30753058195114136,-0.4778367877006531,-0.34748536348342896,-0.3610638976097107,-0.41879504919052124,-3.7477376461029053,-0.8787228465080261,0.4001351594924927,0.4866882562637329,-1.101274013519287,0.018028222024440765,0.022190682590007782,-1.1382445096969604,0.05136306583881378,-0.4163352847099304,-0.30449020862579346,0.5027437806129456,0.8741458654403687,-0.4892065227031708,-0.5048989653587341,0.8408362865447998,0.6337985992431641,0.43587225675582886,0.5350955724716187,1.6241111755371094,-0.642257571220398,-0.34171563386917114,-1.677931308746338,0.38480332493782043,0.06878653168678284,0.5973306894302368,-0.7260037660598755,-0.43156981468200684,-0.243782639503479,-0.06306346505880356,-0.7021966576576233,0.0984923392534256,0.6076358556747437,-0.220374196767807,-0.49931803345680237,0.9552794694900513,1.007577657699585,0.2416793406009674,0.992639422416687,-1.1227760314941406,-1.027159333229065,1.426128625869751,-0.3289276659488678,0.12877698242664337,0.14896151423454285,-0.5202188491821289,0.0019018948078155518,-1.078890085220337,0.2775122821331024,0.05233367159962654,1.0545638799667358,-0.9200878739356995,1.3814353942871094,0.11237745732069016,0.578871488571167,0.4173342287540436,-0.06158943474292755,-0.2005743384361267,0.0559518039226532,-0.0036827102303504944,0.13846813142299652,0.5902286767959595,1.6785902976989746,-0.40656763315200806,-0.17029233276844025,-0.6934882998466492,0.3244873881340027,0.44738978147506714,0.0884454995393753,-0.4109969139099121,0.904796302318573,-0.35765209794044495,-0.35022562742233276,1.1521844863891602,-0.4435582458972931,-1.7490496635437012,1.2719151973724365,0.8546221852302551,0.6288748979568481,0.5567417740821838,0.23537978529930115,-0.2625691890716553,-0.4201691150665283,-0.031887125223875046,-0.23884156346321106,0.4404941499233246,-0.037543125450611115,0.567406415939331,0.7302023768424988,0.23490169644355774,-0.8163228631019592,-0.36913132667541504,0.09247655421495438,-0.11942968517541885,0.2534741759300232,-0.8052893877029419,-0.8180149793624878,0.5631304979324341,-0.6900044083595276,2.0924177169799805,-0.21581509709358215,0.22615094482898712,0.29184532165527344,-0.2611883580684662,-0.29061079025268555,0.34189945459365845,0.060022518038749695,-1.3695883750915527,-0.6030132174491882,-0.29206734895706177,-1.0539348125457764,-0.30442559719085693,-0.5854654312133789,-0.020208176225423813,0.31620773673057556,-0.22225336730480194,-0.3005363941192627,-0.059914734214544296,0.1158532202243805,-0.5216633081436157,-0.4721830487251282,0.6871305704116821,-0.4043724536895752,0.3136741518974304,0.25572580099105835,0.08167874813079834,-0.2194097489118576,0.21849390864372253,0.25725042819976807,-0.8498772978782654,0.13000011444091797,1.2921347618103027,0.8610592484474182,-0.4687685966491699,-0.3027735650539398,0.0011710133403539658,0.44565197825431824,-1.19475519657135,0.12933078408241272,-0.012583471834659576,0.23416516184806824,0.647803008556366,0.08613689243793488,-0.37920325994491577,-0.19718116521835327,0.03673502802848816,-0.4063129425048828,0.12111017107963562,-0.3539409041404724,-0.15851514041423798,0.36572545766830444,0.4645622968673706,-0.18689769506454468,0.1006489247083664,-0.9697158932685852,0.28781089186668396,-0.08998963236808777,-0.22573016583919525,0.29852095246315,-0.012186724692583084,-0.013491332530975342,0.285645991563797,-0.38802313804626465,-0.3337113559246063,-0.5169143676757812,0.09929737448692322,0.28745338320732117,-1.0063592195510864,0.15564261376857758,0.007488846778869629,1.2394287586212158,-0.3071470558643341,0.49926450848579407,-0.36440497636795044,0.15583883225917816,0.9725738167762756,-0.4264935255050659,-0.06153489649295807,0.2686189115047455,-0.2579023241996765,-0.028077170252799988,-0.6492770314216614,0.18346458673477173,0.6539161205291748,-0.5287884473800659,-0.9626326560974121,0.10036218166351318,0.5330377817153931,0.05648833513259888,-0.4138143062591553,0.0561710000038147,0.2276008427143097,-0.3131527006626129,0.45061612129211426,0.5044612884521484,-0.04969185218214989,-0.6182184219360352,0.5720903873443604,0.6490899324417114,0.13527381420135498,0.14514762163162231,-0.7029580473899841,-0.8574134707450867,-0.4192662239074707,0.26599183678627014,0.2869669795036316,0.3119429349899292,0.7251148819923401,0.5306594371795654,-0.30638718605041504,-0.9094123244285583,0.19781897962093353,0.12925885617733002,0.1236269474029541,0.9065103530883789,-0.5574712753295898,0.09498424828052521,-0.25127941370010376,-0.1691375970840454,0.1367999017238617,0.6134654879570007,0.513812780380249,-0.5169202089309692,1.0713099241256714,-0.29011446237564087,-0.9842490553855896,-0.45371362566947937,-0.5409772396087646,-0.9176234006881714,0.4863108694553375,0.49944067001342773,0.9287800788879395,0.24797390401363373,-0.5013788342475891,-0.8737536668777466,-1.1261992454528809,-0.4511915445327759,-0.24193082749843597,-0.5075546503067017,-0.31324267387390137,1.0050700902938843,0.045566484332084656,0.9496373534202576,0.8500314354896545,0.34286144375801086,0.7615549564361572,-0.054583437740802765,-0.6421077251434326,0.5453372597694397,0.3668128252029419,-0.5929552912712097,0.614436149597168,-0.09926802664995193,-0.2010406255722046,-0.6484941840171814,-0.19711294770240784,-0.5808992385864258,0.1694454550743103,-0.5223721265792847,-0.5902420282363892,-0.46219402551651,0.03155353292822838,-0.7903730869293213,0.0782572403550148,-0.6776789426803589,1.0479891300201416,-0.022470925003290176,0.7969536781311035,1.0694361925125122,-0.6171338558197021,-0.2681156396865845,0.3999171853065491,0.35280874371528625,1.0187379121780396,-0.5938916206359863,-0.2004891335964203,-1.4643892049789429,0.23975370824337006,0.18330226838588715,0.3095976412296295,0.5006391406059265,-0.4344342350959778,0.3307136297225952,-0.8931965231895447,-0.5932106971740723,0.7664067149162292,-0.5010986924171448,-0.2825011909008026,-0.262694776058197,0.15670830011367798,-0.5596065521240234,-0.6988359689712524,0.5378687977790833,-0.7848501801490784,-0.22979475557804108,-0.0488881915807724,-0.4720187187194824,-0.32239091396331787,-1.506020188331604,0.11375871300697327,0.22681696712970734,-0.5950865745544434,-0.0627446323633194,-0.11461791396141052,-0.8171451091766357,0.4832627475261688,-0.32235872745513916,0.8042574524879456,0.5015941262245178,-0.5312303900718689,-0.3028644323348999,-1.4791278839111328,-1.3238779306411743,0.26837870478630066,0.4850417673587799,-0.056951139122247696,-0.2028380185365677,-0.027933575212955475,0.7860222458839417,0.11833557486534119,0.19821643829345703,-0.48847416043281555,0.25025105476379395,0.28046363592147827,0.7938079237937927,0.33296623826026917,-0.7502391934394836,0.053352415561676025,0.5538544654846191,0.7403353452682495,-1.6241241693496704,-0.1915905922651291,0.9331102967262268,0.047896433621644974,-1.4785521030426025,-0.9561884999275208,0.45559608936309814,0.7257108092308044,-1.1733038425445557,0.2207261472940445,-1.2168134450912476,0.0850137397646904,0.27688711881637573,-0.2391366809606552,-0.23542433977127075,-0.1191370040178299,-0.03312939405441284,0.2574772238731384,-0.1827012598514557,0.03877359628677368,0.8335729837417603,-0.1194879561662674,0.2522817552089691,3.4318125247955322,0.06397400796413422,0.9019070863723755,0.2084193080663681,-0.4073030352592468,0.42598652839660645,-0.19524912536144257,-0.0106879323720932,0.31513136625289917,0.05389392375946045,-0.4366808831691742,-1.3127474784851074,0.658227801322937,-0.3432815372943878,-0.7515811920166016,0.5082756876945496,2.1259288787841797,0.38811713457107544,-0.07313723862171173,-0.31578007340431213,-0.5424535870552063,0.2443440705537796,-0.20473995804786682,-0.34347665309906006,0.17059417068958282,-1.2148398160934448,0.2137731909751892,-0.2326400727033615,0.016683712601661682,0.4022635221481323,-0.012012075632810593,-0.1743626892566681]))

